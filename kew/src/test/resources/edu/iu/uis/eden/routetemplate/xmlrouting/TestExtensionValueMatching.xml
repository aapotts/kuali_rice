<?xml version="1.0" encoding="UTF-8"?>

<data xmlns="ns:workflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="ns:workflow resource:WorkflowData">
    <ruleAttributes xmlns="ns:workflow/RuleAttribute" xsi:schemaLocation="ns:workflow/RuleAttribute resource:RuleAttribute">
        <ruleAttribute>
            <name>SearchAttribute</name>
            <className>edu.iu.uis.eden.docsearch.MockSearchableAttribute</className>
            <label>SearchAttribute</label>
            <description>SearchAttribute</description>
            <type>SearchableAttribute</type>
        </ruleAttribute>

        <ruleAttribute>
            <name>Attr1</name>
            <className>edu.iu.uis.eden.routetemplate.xmlrouting.StandardGenericXMLRuleAttribute</className>
            <label>Attr1</label>
            <description>Attr1</description>
            <type>RuleXmlAttribute</type>
            <routingConfig>
                <fieldDef name="attr1" title="Choose number" workflowType="RULE">
                    <display>
                        <type>select</type>
                        <values title="1">1</values>
                        <values title="2">2</values>
                        <values title="3">3</values>
                    </display>
                    <validation required="true" />
                    <fieldEvaluation>
                        <!-- expectation: this is run and evaluates to true -->
                        <xpathexpression>string(//xmlRouting/field[@name='attr1']/value) = wf:ruledata('doesNotMatchFieldName')</xpathexpression>
                    </fieldEvaluation>
                </fieldDef>
            </routingConfig>
        </ruleAttribute>
    </ruleAttributes>

    <ruleTemplates xmlns="ns:workflow/RuleTemplate" xsi:schemaLocation="ns:workflow/RuleTemplate resource:RuleTemplate">
        <ruleTemplate allowOverwrite="true">
            <name>Attr1Template</name>
            <description>Attr1Template</description>
            <attributes>
                <attribute>
                    <name>Attr1</name>
                    <required>true</required>
                </attribute>
            </attributes>
        </ruleTemplate>
    </ruleTemplates>

    <documentTypes xmlns="ns:workflow/DocumentType" xsi:schemaLocation="ns:workflow/DocumentType resource:DocumentType">
        <documentType>
            <name>TestDocument</name>
            <description>TestDocument</description>
            <label>TestDocument</label>
            <superUserWorkgroupName>TestWorkgroup</superUserWorkgroupName>
            <blanketApproveWorkgroupName>TestWorkgroup</blanketApproveWorkgroupName>
            <defaultExceptionWorkgroupName>TestWorkgroup</defaultExceptionWorkgroupName>
            <docHandler>http://localhost:8080/en-dev/this/is/a/sample/doc/handler</docHandler>
            <routePaths>
                <routePath>
                    <start name="Initiated" nextNode="Requests1" />
                    <requests name="Requests1"/>
                </routePath>
            </routePaths>
            <routeNodes>
                <start name="Initiated"/>
                <requests name="Requests1">
                    <ruleTemplate>Attr1Template</ruleTemplate>
                </requests>
            </routeNodes>
        </documentType>
    </documentTypes>

    <rules xmlns="ns:workflow/Rule" xsi:schemaLocation="ns:workflow/Rule resource:Rule">
        <!-- Attr1-based rules -->
        <rule>
            <documentType>TestDocument</documentType>
            <ruleTemplate>Attr1Template</ruleTemplate>
            <description>Attr1Template Rule matching '1'</description>
            <ignorePrevious>true</ignorePrevious>
            <ruleExtensions>
                <ruleExtension>
                    <attribute>Attr1</attribute>
                    <ruleTemplate>Attr1Template</ruleTemplate>
                    <ruleExtensionValues>
                        <ruleExtensionValue>
                            <!-- if this is changed to 'attr1' to match an attribute field NAME
                                 then that attribute field match xpath expression will be run,
                                 otherwise it will NOT, and will default to a match -->
                            <key>doesNotMatchFieldName</key>
                            <value>1</value>
                        </ruleExtensionValue>
                    </ruleExtensionValues>
                </ruleExtension>
            </ruleExtensions>
            <responsibilities>
                <responsibility><user>user1</user></responsibility>
            </responsibilities>
        </rule>
        <rule>
            <documentType>TestDocument</documentType>
            <ruleTemplate>Attr1Template</ruleTemplate>
            <description>Attr1Template Rule matching '1'</description>
            <ignorePrevious>true</ignorePrevious>
            <ruleExtensions>
                <ruleExtension>
                    <attribute>Attr1</attribute>
                    <ruleTemplate>Attr1Template</ruleTemplate>
                    <ruleExtensionValues>
                        <ruleExtensionValue>
                            <!-- if this is changed to 'attr1' to match an attribute field NAME
                                 then that attribute field match xpath expression will be run,
                                 otherwise it will NOT, and will default to a match -->
                            <key>doesNotMatchFieldName</key>
                            <value>2</value>
                        </ruleExtensionValue>
                    </ruleExtensionValues>
                </ruleExtension>
            </ruleExtensions>
            <responsibilities>
                <responsibility><user>user2</user></responsibility>
            </responsibilities>
        </rule>
    </rules>
</data>